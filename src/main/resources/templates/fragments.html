<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <title th:text="${title}">PawPal</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</head>

<body>

    <!-- HEADER HOMEPAGE -->
    <header th:fragment="navbar(active)">

        <nav class="navbar navbar-expand-lg bg-body-tertiary">

            <div class="container-fluid">

                <!-- LOGO -->
                <a class="navbar-brand" th:href="@{/}">
                    <img src="" alt="">
                </a>

                <!-- BOTTONE COLLAPSE -->
                <button 
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNavDropdown"
                    aria-controls="navbarNavDropdown"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon">Prova</span>
                </button>


                <div class="collapse navbar-collapse" id="navbarNavDropdown">

                    <!-- LINK A SINISTRA -->

                    <ul class="navbar-nav">

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/}" th:classappend="${active} == 'home' ? ' active' : ''">Home</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/veterinari/lista_veterinari}" th:classappend="${active} == 'lista_veterinari' ? ' active' : ''">Veterinari</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/contatti}" th:classappend="${active} == 'contatti' ? ' active' : ''">Contatti</a>
                        </li>

                    </ul>

                    <!-- LINK A DESTRA -->

                    <ul class="navbar-nav ms-auto">

                        <!-- <ANONIMO> -->
                        <div sec:authorize="isAnonymous()" style="display: contents;">

                            <li class="nav-item">
                                <button class="btn btn-secondary" data-bs-target="#loginModal" data-bs-toggle="modal">Login</button>
                            </li>

                            <li class="nav-item">
                                <button class="btn btn-secondary" data-bs-target="#registrazioneClienteModal" data-bs-toggle="modal">Registrati come cliente</button>
                            </li>

                            <li class="nav-item">
                                <button class="btn btn-secondary" data-bs-target="#registrazioneVeterinarioModal" data-bs-toggle="modal">Registrati come veterinario</button>
                            </li>

                        </div>
                        <!-- </ANONIMO> -->

                        <!-- <CLIENTE-VETERINARIO> -->
                        <div sec:authorize="hasAnyRole('CLIENTE','VETERINARIO')" style="display: contents;">

                            <li class="nav-item dropdown">

                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <span th:text="${#authentication.name}">Utente</span>
                                </a>

                                <ul class="dropdown-menu">

                                    <li>
                                        <p class="dropdown-item">
                                            <span th:if="${#authorization.expression('hasRole(''CLIENTE'')')}"><strong><em>Cliente</em></strong></span>
                                            <span th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}"><strong><em>Veterinario</em></strong></span>
                                        </p>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/profilo}">Profilo</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/appuntamenti}">Appuntamenti</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/recensioni}">Recensioni</a>
                                    </li>

                                    <li th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}">
                                        <a class="dropdown-item" th:href="@{/dash/linee_guida}">Linee guida</a>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <form id="navbar_logout_form" th:action="@{/logout}" method="post" style="display: contents;">
                                            <a class="dropdown-item" href="#" onclick="document.getElementById('navbar_logout_form').submit()">Logout</a>
                                        </form>
                                    </li>

                                </ul>

                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/dash}">Dashboard</a>
                            </li>

                        </div>
                        <!-- </CLIENTE-VETERINARIO> -->

                        <!-- <ADMIN> -->
                        <div sec:authorize="hasRole('ADMIN')" style="display: contents;">

                            <li class="nav-item dropdown">

                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <span th:text="${#authentication.name}">Admin</span>
                                </a>

                                <ul class="dropdown-menu">

                                    <li>
                                        <p class="dropdown-item">
                                            <span><strong><em>Admin</em></strong></span>
                                        </p>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/utenti}">Utenti</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/prestazioni}">Prestazioni</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/specie}">Specie</a>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <form id="navbar_logout_form" th:action="@{/logout}" method="post" style="display: contents;">
                                            <a class="dropdown-item" href="#" onclick="document.getElementById('navbar_logout_form').submit()">Logout</a>
                                        </form>
                                    </li>

                                </ul>

                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/admin}">Dashboard</a>
                            </li>

                        </div>
                        <!-- </ADMIN> -->

                    </ul>

                </div>

            </div>

        </nav>

    </header>

    <!-- HEADER DASHBOARD -->
    <header th:fragment="dashboard-header(title)">

        <div class="header-left">
            <button class="toggle-btn" type="button" aria-label="Apri sidebar">☰</button>
            <h2 class="header-title" th:text="${title}">Dashboard</h2>
        </div>

        <div class="header-right">
            <a th:href="@{/}" class="btn-home">Home</a>

            <div class="profile" aria-haspopup="true">

                <button class="profile-btn" type="button" aria-expanded="false">
                    <span th:text="${#authentication.name}">Nome Utente</span> ▾
                </button>

                <div class="profile-dropdown" role="menu" aria-hidden="true">

                    <div class="profile-info">

                        <div class="profile-name" th:text="${#authentication.name}">Utente</div>

                        <div class="profile-role">
                            <span th:if="${#authorization.expression('hasRole(''CLIENTE'')')}">Cliente</span>
                            <span th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}">Veterinario</span>
                            <span th:if="${#authorization.expression('hasRole(''ADMIN'')')}">Amministratore</span>
                        </div>

                    </div>

                    <ul class="profile-actions">
                        <li><a th:href="@{/}">Home</a></li>
                        <li><a th:href="@{/dash/profilo}">Profilo</a></li>
                        <li>
                            <form th:action="@{/logout}" method="post">
                                <button type="submit">Logout</button>
                            </form>
                        </li>
                    </ul>

                </div>

            </div>

        </div>
        
    </header>

    <!-- SECTION RICERCA VETERINARI -->
    <section th:fragment="ricerca_veterinari">

        <div class="container-fluid">

            <div class="row">

                <div class="col-12 text-center">
                    <h2>Trova il veterinario più adatto alle tue esigenze vicino a te</h2>
                </div>

            </div>

            <form th:action="@{/veterinari/lista_veterinari}" method="get" style="display: contents;">

                <div class="row">

                    <div class="col-2"></div>

                    <div class="col-8 text-center">
                        <label class="form-label" for="citta">Città</label>
                        <select class="form-select" name="citta" id="citta">
                            <option value="" selected>-- Seleziona --</option>
                            <option value="agrigento">Agrigento</option>
                            <option value="alessandria">Alessandria</option>
                            <option value="ancona">Ancona</option>
                            <option value="aosta">Aosta</option>
                            <option value="arezzo">Arezzo</option>
                            <option value="ascoli piceno">Ascoli Piceno</option>
                            <option value="asti">Asti</option>
                            <option value="avellino">Avellino</option>
                            <option value="bari">Bari</option>
                            <option value="barletta-andria-trani">Barletta-Andria-Trani</option>
                            <option value="belluno">Belluno</option>
                            <option value="benevento">Benevento</option>
                            <option value="bergamo">Bergamo</option>
                            <option value="biella">Biella</option>
                            <option value="bologna">Bologna</option>
                            <option value="bolzano">Bolzano</option>
                            <option value="brescia">Brescia</option>
                            <option value="brindisi">Brindisi</option>
                            <option value="cagliari">Cagliari</option>
                            <option value="caltanissetta">Caltanissetta</option>
                            <option value="campobasso">Campobasso</option>
                            <option value="caserta">Caserta</option>
                            <option value="catania">Catania</option>
                            <option value="catanzaro">Catanzaro</option>
                            <option value="chieti">Chieti</option>
                            <option value="como">Como</option>
                            <option value="cosenza">Cosenza</option>
                            <option value="cremona">Cremona</option>
                            <option value="crotone">Crotone</option>
                            <option value="cuneo">Cuneo</option>
                            <option value="enna">Enna</option>
                            <option value="fermo">Fermo</option>
                            <option value="ferrara">Ferrara</option>
                            <option value="firenze">Firenze</option>
                            <option value="foggia">Foggia</option>
                            <option value="forlì-cesena">Forlì-Cesena</option>
                            <option value="frosinone">Frosinone</option>
                            <option value="genova">Genova</option>
                            <option value="gorizia">Gorizia</option>
                            <option value="grosseto">Grosseto</option>
                            <option value="imperia">Imperia</option>
                            <option value="isernia">Isernia</option>
                            <option value="l'aquila">L'Aquila</option>
                            <option value="la spezia">La Spezia</option>
                            <option value="latina">Latina</option>
                            <option value="lecce">Lecce</option>
                            <option value="lecco">Lecco</option>
                            <option value="livorno">Livorno</option>
                            <option value="lodi">Lodi</option>
                            <option value="lucca">Lucca</option>
                            <option value="macerata">Macerata</option>
                            <option value="mantova">Mantova</option>
                            <option value="massa-carrara">Massa-Carrara</option>
                            <option value="matera">Matera</option>
                            <option value="messina">Messina</option>
                            <option value="milano">Milano</option>
                            <option value="modena">Modena</option>
                            <option value="monza e della brianza">Monza e della Brianza</option>
                            <option value="napoli">Napoli</option>
                            <option value="novara">Novara</option>
                            <option value="nuoro">Nuoro</option>
                            <option value="oristano">Oristano</option>
                            <option value="padova">Padova</option>
                            <option value="palermo">Palermo</option>
                            <option value="parma">Parma</option>
                            <option value="pavia">Pavia</option>
                            <option value="perugia">Perugia</option>
                            <option value="pesaro e urbino">Pesaro e Urbino</option>
                            <option value="pescara">Pescara</option>
                            <option value="piacenza">Piacenza</option>
                            <option value="pisa">Pisa</option>
                            <option value="pistoia">Pistoia</option>
                            <option value="pordenone">Pordenone</option>
                            <option value="potenza">Potenza</option>
                            <option value="prato">Prato</option>
                            <option value="ragusa">Ragusa</option>
                            <option value="ravenna">Ravenna</option>
                            <option value="reggio calabria">Reggio Calabria</option>
                            <option value="reggio emilia">Reggio Emilia</option>
                            <option value="rieti">Rieti</option>
                            <option value="rimini">Rimini</option>
                            <option value="roma">Roma</option>
                            <option value="rovigo">Rovigo</option>
                            <option value="salerno">Salerno</option>
                            <option value="sassari">Sassari</option>
                            <option value="savona">Savona</option>
                            <option value="siena">Siena</option>
                            <option value="siracusa">Siracusa</option>
                            <option value="sondrio">Sondrio</option>
                            <option value="sud sardegna">Sud Sardegna</option>
                            <option value="taranto">Taranto</option>
                            <option value="teramo">Teramo</option>
                            <option value="terni">Terni</option>
                            <option value="torino">Torino</option>
                            <option value="trapani">Trapani</option>
                            <option value="trento">Trento</option>
                            <option value="treviso">Treviso</option>
                            <option value="trieste">Trieste</option>
                            <option value="udine">Udine</option>
                            <option value="varese">Varese</option>
                            <option value="venezia">Venezia</option>
                            <option value="verbano-cusio-ossola">Verbano-Cusio-Ossola</option>
                            <option value="vercelli">Vercelli</option>
                            <option value="verona">Verona</option>
                            <option value="vibo valentia">Vibo Valentia</option>
                            <option value="vicenza">Vicenza</option>
                            <option value="viterbo">Viterbo</option>
                        </select>
                    </div>

                    <div class="col-2"></div>

                </div>

                <div class="row">

                    <div class="col-2"></div>

                    <div class="col-8 text-center">
                        <label class="form-label" for="prestazione">Prestazione</label>
                        <select class="form-select" id="prestazione" name="idPrestazione">
                            <option value="" selected>-- Seleziona --</option>
                            <option th:each="prest : ${lista_prestazioni}" th:value="${prest.id}" th:text="${prest.descrizione}"></option>
                        </select>
                    </div>

                    <div class="col-2"></div>

                </div>

                <div class="row">

                    <div class="col-2"></div>

                    <div class="col-8 text-center">
                        <label class="form-label" for="specie">Animale</label>
                        <select class="form-select" id="specie" name="idSpecie">
                            <option value="" selected>-- Seleziona --</option>
                            <option th:each="spec : ${lista_specie}" th:value="${spec.id}" th:text="${spec.nomeSpecie}"></option>
                        </select>
                    </div>

                    <div class="col-2"></div>

                </div>

                <div class="row">

                    <div class="col-4"></div>

                    <div class="col-4 text-center">
                        <button class="btn btn-outline-success" type="submit">Cerca</button>
                    </div>

                    <div class="col-4"></div>

                </div>

            </form>

        </div>

    </section>

    <section th:fragment="login">

        <div class="modal fade" id="loginModal" aria-hidden="true" aria-labelledby="loginLabel" tabindex="-1">

            <div class="modal-dialog modal-dialog-centered">

                <div class="modal-content">

                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="loginLabel">Accedi a Pawpal</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body text-center">
                        <form th:action="@{/auth/login/form}" method="post" style="display: contents;">
    
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

                            <div>
                                <label class="form-label" for="username">Username:</label>
                                <input class="form-control" type="text" id="username" name="username" placeholder="Inserisci username" required>
                            </div>

                            <div>
                                <label class="form-label" for="password">Password:</label>
                                <input class="form-control" type="password" id="password" name="password" placeholder="Inserisci password" required>
                            </div>

                            <button type="submit" class="btn btn-secondary">Accedi</button>

                        </form>
                    </div>

                    <div class="modal-footer">
                        <h4>Non hai un account?</h4>
                        <button class="btn btn-secondary" data-bs-target="#registrazioneClienteModal" data-bs-toggle="modal">Registrati come cliente</button>
                        <button class="btn btn-secondary" data-bs-target="#registrazioneVeterinarioModal" data-bs-toggle="modal">Registrati come veterinario</button>
                    </div>

                </div>

            </div>

        </div>

    </section>

    <section th:fragment="registrazione_cliente">

        <div class="modal fade" id="registrazioneClienteModal" aria-hidden="true" aria-labelledby="registrazioneClienteLabel" tabindex="-1">
            
            <div class="modal-dialog modal-dialog-centered">

                <div class="modal-content">

                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="registrazioneClienteLabel">Registrazione Cliente</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body text-center">
                        <form th:action="@{/auth/register_cliente}" method="post" style="display: contents;">

                            <div>
                                <label class="form-label" for="nome_cliente">Nome:</label>
                                <input class="form-control" type="text" id="nome_cliente" name="nome" required>
                            </div>

                            <div>
                                <label class="form-label" for="cognome_cliente">Cognome:</label>
                                <input class="form-control" type="text" id="cognome_cliente" name="cognome" required>
                            </div>

                            <div>
                                <label class="form-label" for="codice_fiscale_cliente">Codice Fiscale:</label>
                                <input class="form-control" type="text" id="codice_fiscale_cliente" name="codiceFiscale" maxlength="16" required>
                            </div>

                            <div>
                                <label class="form-label" for="telefono_cliente">Telefono:</label>
                                <input class="form-control" type="text" id="telefono_cliente" name="telefono" required>
                            </div>

                            <div>
                                <label class="form-label" for="email_cliente">Email:</label>
                                <input class="form-control" type="email" id="email_cliente" name="email" required>
                            </div>

                            <div>
                                <label class="form-label" for="username_cliente">Username:</label>
                                <input class="form-control" type="text" id="username_cliente" name="username" required>
                            </div>

                            <div>
                                <label class="form-label" for="password_cliente">Password:</label>
                                <input class="form-control" type="password" id="password_cliente" name="password" required>
                            </div>

                            <div>
                                <label class="form-label" for="check_password_cliente">Conferma Password:</label>
                                <input class="form-control" type="password" id="check_password_cliente" name="check_password" oninput="verificaPasswordCliente()" required>
                            </div>

                            <div id="check_password_error_cliente" class="alert alert-danger" role="alert" style="display: none;">
                                Le password non corrispondono!
                            </div>

                            <input type="hidden" name="ruolo" value="CLIENTE">

                            <button class="btn btn-secondary" type="reset">Reset</button>
                            <button class="btn btn-secondary" type="submit">Registrami</button>

                        </form>
                    </div>

                    <div class="modal-footer">
                        <h4>Hai gi&#224; un account?</h4>
                        <button class="btn btn-secondary" data-bs-target="#loginModal" data-bs-toggle="modal">Accedi</button>
                    </div>

                </div>

            </div>

        </div>

    </section>

    <section th:fragment="registrazione_veterinario">

        <div class="modal fade" id="registrazioneVeterinarioModal" aria-hidden="true" aria-labelledby="registrazioneVeterinarioLabel" tabindex="-1">
            
            <div class="modal-dialog modal-dialog-centered">

                <div class="modal-content">

                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="registrazioneVeterinarioLabel">Registrazione Veterinario</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body text-center">
                        <form th:action="@{/auth/register_veterinario}" method="post" style="display: contents;">

                            <div>
                                <label class="form-label" for="nome_veterinario">Nome:</label>
                                <input class="form-control" type="text" id="nome_veterinario" name="nome" required>
                            </div>

                            <div>
                                <label class="form-label" for="cognome_veterinario">Cognome:</label>
                                <input class="form-control" type="text" id="cognome_veterinario" name="cognome" required>
                            </div>

                            <div>
                                <label class="form-label" for="codice_fiscale_veterinario">Codice Fiscale:</label>
                                <input class="form-control" type="text" id="codice_fiscale_veterinario" name="codiceFiscale" maxlength="16" required>
                            </div>

                            <div>
                                <label class="form-label" for="telefono_veterinario">Telefono:</label>
                                <input class="form-control" type="text" id="telefono_veterinario" name="telefono" required>
                            </div>

                            <div>
                                <label class="form-label" for="email_veterinario">Email:</label>
                                <input class="form-control" type="email" id="email_veterinario" name="email" required>
                            </div>

                            <div>
                                <label class="form-label" for="username_veterinario">Username:</label>
                                <input class="form-control" type="text" id="username_veterinario" name="username" required>
                            </div>

                            <div>
                                <label class="form-label" for="password_veterinario">Password:</label>
                                <input class="form-control" type="password" id="password_veterinario" name="password" required>
                            </div>

                            <div>
                                <label class="form-label" for="check_password_veterinario" oninput="verificaPasswordVeterinario()">Conferma Password:</label>
                                <input class="form-control" type="password" id="check_password_veterinario" name="check_password" required>
                            </div>

                            <div>
                                <label class="form-label" for="specializzazione_veterinario">Specializzazione:</label>
                                <input class="form-control" type="text" id="specializzazione_veterinario" name="specializzazione" required>
                            </div>

                            <div>
                                <label class="form-label">Specie trattate:</label>
                                <div class="btn-group" role="group" aria-label="specie trattate dal veterinario">
                                    <div th:each="spec : ${lista_specie}" style="display: contents;">
                                        <input type="checkbox" class="btn-check" name="specie" th:value="${spec.id}" th:id="'specie_' + ${spec.id}" />
                                        <label class="btn btn-outline-primary" th:for="'specie_' + ${spec.id}">
                                            <span th:text="${spec.nomeSpecie}">Nome Specie</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="form-label">Prestazioni offerte:</label>
                                <div class="btn-group" role="group" aria-label="prestazioni offerte dal veterinario">
                                    <div th:each="prest : ${lista_prestazioni}" style="display: contents;">
                                        <input type="checkbox" class="btn-check" name="prestazioni" th:value="${prest.id}" th:id="'prestazione_' + ${prest.id}" />
                                        <label class="btn btn-outline-primary" th:for="'prestazione_' + ${prest.id}">
                                            <span th:text="${prest.descrizione}">Nome Prestazione</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="form-label" for="indirizzo_studio_veterinario">Indirizzo studio:</label>
                                <input class="form-control" type="text" id="indirizzo_studio_veterinario" name="indirizzoStudio" placeholder="Via, numero civico, città" required>
                            </div>

                            <div>
                                <label class="form-label" for="iscrizione_albo_veterinario">Numero di iscrizione all&#39;albo:</label>
                                <input class="form-control" type="text" id="iscrizione_albo_veterinario" name="iscrizioneAlbo" placeholder="es. 12345" required>
                            </div>

                            <div>
                                <label class="form-label" for="disponibilita_veterinario">Disponibilit&#224;:</label>
                                <input class="form-control" type="text" id="disponibilita_veterinario" name="disponibilita" placeholder="es. Lun-Ven 9:00-18:00" required>
                            </div>

                            <div>
                                <label class="form-label" for="descrizione_veterinario">Descrizione:</label>
                                <textarea class="form-control" name="descrizione" id="descrizione_veterinario" maxlength="140"></textarea>
                            </div>

                            <input type="hidden" name="ruolo" value="VETERINARIO">

                            <button class="btn btn-secondary" type="reset">Reset</button>
                            <button class="btn btn-secondary" type="submit">Registrami</button>

                        </form>
                    </div>

                    <div class="modal-footer">
                        <h4>Hai già un account?</h4>
                        <button class="btn btn-secondary" data-bs-target="#loginModal" data-bs-toggle="modal">Accedi</button>
                    </div>

                </div>

            </div>

        </div>
        
    </section>

    <footer th:fragment="footer">

        <div class="footer-content">
            <p>&copy; 2024 PawPal. Tutti i diritti riservati.</p>
        </div>

    </footer>

</body>

</html>