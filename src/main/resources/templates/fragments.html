<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <title th:text="${title}">PawPal</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</head>

<body>

    <header th:fragment="navbar(active)">

        <nav class="navbar navbar-expand-lg bg-body-tertiary">

            <div class="container-fluid">

                <!-- LOGO -->
                <a class="navbar-brand" th:href="@{/}">
                    <img src="" alt="">
                </a>

                <!-- BOTTONE COLLAPSE -->
                <button 
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNavDropdown"
                    aria-controls="navbarNavDropdown"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon">Prova</span>
                </button>


                <div class="collapse navbar-collapse" id="navbarNavDropdown">

                    <!-- LINK A SINISTRA -->

                    <ul class="navbar-nav">

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/}" th:classappend="${active} == 'home' ? ' active' : ''">Home</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/veterinari/lista_veterinari}" th:classappend="${active} == 'lista_veterinari' ? ' active' : ''">Veterinari</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/contatti}" th:classappend="${active} == 'contatti' ? ' active' : ''">Contatti</a>
                        </li>

                    </ul>

                    <!-- LINK A DESTRA -->

                    <ul class="navbar-nav ms-auto">

                        <!-- <ANONIMO> -->
                        <div sec:authorize="isAnonymous()" style="display: contents;">

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/auth/login}" th:classappend="${active} == 'login' ? ' active' : ''">Login</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/auth/register_cliente}" th:classappend="${active} == 'register_cliente' ? ' active' : ''">Registrati come cliente</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/auth/register_veterinario}" th:classappend="${active} == 'register_veterinario' ? ' active' : ''">Registrati come veterinario</a>
                            </li>

                        </div>
                        <!-- </ANONIMO> -->

                        <!-- <CLIENTE-VETERINARIO> -->
                        <div sec:authorize="hasAnyRole('CLIENTE','VETERINARIO')" style="display: contents;">

                            <li class="nav-item dropdown">

                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <span th:text="${#authentication.name}">Utente</span>
                                </a>

                                <ul class="dropdown-menu">

                                    <li>
                                        <p class="dropdown-item">
                                            <span th:if="${#authorization.expression('hasRole(''CLIENTE'')')}"><strong><em>Cliente</em></strong></span>
                                            <span th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}"><strong><em>Veterinario</em></strong></span>
                                        </p>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/profilo}">Profilo</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/appuntamenti}">Appuntamenti</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/dash/recensioni}">Recensioni</a>
                                    </li>

                                    <li th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}">
                                        <a class="dropdown-item" th:href="@{/dash/linee_guida}">Linee guida</a>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <form id="navbar_logout_form" th:action="@{/logout}" method="post" style="display: contents;">
                                            <a class="dropdown-item" href="#" onclick="document.getElementById('navbar_logout_form').submit()">Logout</a>
                                        </form>
                                    </li>

                                </ul>

                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/dash}">Dashboard</a>
                            </li>

                        </div>
                        <!-- </CLIENTE-VETERINARIO> -->

                        <!-- <ADMIN> -->
                        <div sec:authorize="hasRole('ADMIN')" style="display: contents;">

                            <li class="nav-item dropdown">

                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <span th:text="${#authentication.name}">Admin</span>
                                </a>

                                <ul class="dropdown-menu">

                                    <li>
                                        <p class="dropdown-item">
                                            <span><strong><em>Admin</em></strong></span>
                                        </p>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/utenti}">Utenti</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/prestazioni}">Prestazioni</a>
                                    </li>

                                    <li>
                                        <a class="dropdown-item" th:href="@{/admin/specie}">Specie</a>
                                    </li>

                                    <li><hr class="dropdown-divider"></li>

                                    <li>
                                        <form id="navbar_logout_form" th:action="@{/logout}" method="post" style="display: contents;">
                                            <a class="dropdown-item" href="#" onclick="document.getElementById('navbar_logout_form').submit()">Logout</a>
                                        </form>
                                    </li>

                                </ul>

                            </li>

                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/admin}">Dashboard</a>
                            </li>

                        </div>
                        <!-- </ADMIN> -->

                    </ul>

                </div>

            </div>

        </nav>

    </header>

    <header th:fragment="dashboard-header(title)">

        <div class="header-left">
            <button class="toggle-btn" type="button" aria-label="Apri sidebar">☰</button>
            <h2 class="header-title" th:text="${title}">Dashboard</h2>
        </div>

        <div class="header-right">
            <a th:href="@{/}" class="btn-home">Home</a>

            <div class="profile" aria-haspopup="true">

                <button class="profile-btn" type="button" aria-expanded="false">
                    <span th:text="${#authentication.name}">Nome Utente</span> ▾
                </button>

                <div class="profile-dropdown" role="menu" aria-hidden="true">

                    <div class="profile-info">

                        <div class="profile-name" th:text="${#authentication.name}">Utente</div>

                        <div class="profile-role">
                            <span th:if="${#authorization.expression('hasRole(''CLIENTE'')')}">Cliente</span>
                            <span th:if="${#authorization.expression('hasRole(''VETERINARIO'')')}">Veterinario</span>
                            <span th:if="${#authorization.expression('hasRole(''ADMIN'')')}">Amministratore</span>
                        </div>

                    </div>

                    <ul class="profile-actions">
                        <li><a th:href="@{/}">Home</a></li>
                        <li><a th:href="@{/dash/profilo}">Profilo</a></li>
                        <li>
                            <form th:action="@{/logout}" method="post">
                                <button type="submit">Logout</button>
                            </form>
                        </li>
                    </ul>

                </div>

            </div>

        </div>
        
    </header>

    <footer th:fragment="footer">
        <div class="footer-content">
            <p>&copy; 2024 PawPal. Tutti i diritti riservati.</p>
        </div>
    </footer>

</body>

</html>