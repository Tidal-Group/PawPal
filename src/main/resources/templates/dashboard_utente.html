<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments :: head('Dashboard - PawPal')">
</head>

<body>

    <header th:replace="fragments :: dashboard-header('Dashboard Utente')"></header>

    <div class="sidebar">
        <div class="sidebar-header">
            <h3>Dashboard</h3>
        </div>

        <nav class="sidebar-nav">
            <ul>
                <li><a th:href="@{/dash/home}">Home</a></li>

                <li><a th:href="@{/dash/appuntamenti}">Appuntamenti</a></li>
                <li><a th:href="@{/dash/recensioni}">Recensioni</a></li>

                <li th:if="${#strings.equalsIgnoreCase(user.role,'CLIENTE')}">
                    <a th:href="@{/veterinari/lista_veterinari}">Cerca Veterinari</a>
                </li>

                <li th:if="${#strings.equalsIgnoreCase(user.role,'VETERINARIO')}">
                    <a th:href="@{/dash/lineeguida}">Linee Guida</a>
                </li>

                <li class="submenu">
                    <a href="#">Profilo</a>
                    <ul>
                        <li><a th:href="@{/dash/profilo}">Modifica</a></li>
                        <li><a th:href="@{/dash/utenti/modifica_password}">Cambia Password</a></li>
                        <li><a th:href="@{/dash/utenti/elimina_account}">Elimina Account</a></li>
                        <li><a th:href="@{/logout}">Logout</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </div>

    <main class="main-content">
        <section class="modifica-profilo">
            <h1>Modifica profilo</h1>

            <form th:action="@{/dash/profilo/modifica_dati}" method="post" class="form-profilo">
                
                <fieldset>
                    <legend>Informazioni Personali</legend>

                    <label for="nome">Nome</label>
                    <input id="nome" name="nome" type="text" th:value="${#strings.defaultString(user.nome,'')}" />

                    <label for="cognome">Cognome</label>
                    <input id="cognome" name="cognome" type="text"
                        th:value="${#strings.defaultString(user.cognome,'')}" />

                    <label for="telefono">Telefono</label>
                    <input id="telefono" name="telefono" type="tel"
                        th:value="${#strings.defaultString(user.telefono,'')}" />

                    <label for="codiceFiscale">Codice fiscale</label>
                    <input id="codiceFiscale" name="codiceFiscale" type="text"
                        th:value="${#strings.defaultString(user.codiceFiscale,'')}" />
                </fieldset>

                
                <fieldset>
                    <legend>Informazioni Account</legend>

                    <label for="username">Username</label>
                    <input id="username" name="username" type="text"
                        th:value="${#strings.defaultString(user.username,'')}" />

                    <label for="email">Email</label>
                    <input id="email" name="email" type="email" th:value="${#strings.defaultString(user.email,'')}" />
                </fieldset>

                <section th:if="${#strings.equalsIgnoreCase(user.role,'VETERINARIO')}">
                    <fieldset>
                        <legend>Informazioni professionali</legend>

                        <label for="indirizzo">Indirizzo</label>
                        <input id="indirizzo" name="indirizzo" type="text"
                            th:value="${#strings.defaultString(user.indirizzo,'')}" />

                        <label for="specializzazione">Specializzazione</label>
                        <input id="specializzazione" name="specializzazione" type="text"
                            th:value="${#strings.defaultString(user.specializzazione,'')}" />

                        <div class="specie-section">
                            <label>Specie</label>
                            <ul>
                                <li th:each="spec, sStat : ${user.specie}">
                                    <input type="text" th:name="'specie[' + ${sStat.index} + ']'" th:value="${spec}" />
                                    <button type="button" class="remove-specie">Rimuovi</button>
                                </li>
                            </ul>
                            <div class="specie-add">
                                <input type="text" id="newSpecie" placeholder="Aggiungi specie">
                                <button type="button" class="add-specie">Aggiungi specie</button>
                            </div>
                        </div>

                        <div class="prestazioni-section">
                            <label>Prestazioni</label>

                            <div th:each="prest, pStat : ${user.prestazioni}" class="prestazione-item">
                                <input type="hidden" th:name="'prestazioni[' + ${pStat.index} + '].id'"
                                    th:value="${prest.id}" />
                                <label>Nome</label>
                                <input type="text" th:name="'prestazioni[' + ${pStat.index} + '].nome'"
                                    th:value="${#strings.defaultString(prest.nome,'')}" />
                                <label>Prezzo</label>
                                <input type="number" step="0.01" th:name="'prestazioni[' + ${pStat.index} + '].prezzo'"
                                    th:value="${#strings.defaultString(prest.prezzo,'')}" />
                                <label>Durata media (min)</label>
                                <input type="number" th:name="'prestazioni[' + ${pStat.index} + '].durata'"
                                    th:value="${#strings.defaultString(prest.durata,'')}" />
                                <label>Descrizione</label>
                                <textarea th:name="'prestazioni[' + ${pStat.index} + '].descrizione'">
                                        <span th:text="${#strings.defaultString(prest.descrizione,'')}"></span>
                                    </textarea>
                                <button type="button" class="remove-prestazione">Rimuovi prestazione</button>
                            </div>

                            
                            <div class="prestazione-add">
                                <h4>Aggiungi prestazione</h4>
                                <label>Nome</label>
                                <input type="text" id="nuova_prest_nome" name="nuovaPrestazione.nome"
                                    placeholder="Nome prestazione">
                                <label>Prezzo</label>
                                <input type="number" step="0.01" id="nuova_prest_prezzo" name="nuovaPrestazione.prezzo"
                                    placeholder="Prezzo">
                                <label>Durata media (min)</label>
                                <input type="number" id="nuova_prest_durata" name="nuovaPrestazione.durata"
                                    placeholder="Durata media">
                                <label>Descrizione</label>
                                <textarea id="nuova_prest_descrizione" name="nuovaPrestazione.descrizione"
                                    placeholder="Descrizione"></textarea>
                                <button type="button" class="add-prestazione">Aggiungi prestazione</button>
                            </div>
                        </div>

                       
                        <div class="disponibilita-section">
                            <label>Disponibilità</label>

                            <div th:each="disp, dStat : ${user.disponibilita}" class="disponibilita-item">
                                <label>Giorno</label>
                                <select th:name="'disponibilita[' + ${dStat.index} + '].giorno'">
                                    <option th:selected="${disp.giorno == 'LUNEDI'}" value="LUNEDI">Lunedì</option>
                                    <option th:selected="${disp.giorno == 'MARTEDI'}" value="MARTEDI">Martedì</option>
                                    <option th:selected="${disp.giorno == 'MERCOLEDI'}" value="MERCOLEDI">Mercoledì
                                    </option>
                                    <option th:selected="${disp.giorno == 'GIOVEDI'}" value="GIOVEDI">Giovedì</option>
                                    <option th:selected="${disp.giorno == 'VENERDI'}" value="VENERDI">Venerdì</option>
                                    <option th:selected="${disp.giorno == 'SABATO'}" value="SABATO">Sabato</option>
                                    <option th:selected="${disp.giorno == 'DOMENICA'}" value="DOMENICA">Domenica
                                    </option>
                                </select>

                                <label>Inizio</label>
                                <input type="time" th:name="'disponibilita[' + ${dStat.index} + '].inizio'"
                                    th:value="${#strings.defaultString(disp.inizio,'')}" />

                                <label>Fine</label>
                                <input type="time" th:name="'disponibilita[' + ${dStat.index} + '].fine'"
                                    th:value="${#strings.defaultString(disp.fine,'')}" />

                                <button type="button" class="remove-disponibilita">Rimuovi</button>
                            </div>

                        
                            <div class="disponibilita-add">
                                <label>Giorno</label>
                                <select id="newDispGiorno" name="nuovaDisponibilita.giorno">
                                    <option value="LUNEDI">Lunedì</option>
                                    <option value="MARTEDI">Martedì</option>
                                    <option value="MERCOLEDI">Mercoledì</option>
                                    <option value="GIOVEDI">Giovedì</option>
                                    <option value="VENERDI">Venerdì</option>
                                    <option value="SABATO">Sabato</option>
                                    <option value="DOMENICA">Domenica</option>
                                </select>
                                <label>Inizio</label>
                                <input type="time" id="newDispInizio" name="nuovaDisponibilita.inizio">
                                <label>Fine</label>
                                <input type="time" id="newDispFine" name="nuovaDisponibilita.fine">
                                <button type="button" class="add-disponibilita">Aggiungi disponibilità</button>
                            </div>
                        </div>

                        <label for="descrizione">Descrizione</label>
                        <textarea id="descrizione" name="descrizione"
                            th:text="${#strings.defaultString(user.descrizione,'')}"></textarea>
                    </fieldset>
                </section>

                
                <div class="form-actions">
                    <button type="submit">Salva modifiche</button>
                    <a th:href="@{/dash}" class="btn-cancel">Annulla</a>
                </div>
            </form>
        </section>
    </main>

</body>

</html>